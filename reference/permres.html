<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Permute residuals for a fitted ncvreg model — permres • ncvreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Permute residuals for a fitted ncvreg model — permres"><meta property="og:description" content="Fits multiple penalized regression models in which the residuals are
randomly permuted, thereby allowing estimation of the marginal false
discovery rate."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ncvreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.14.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/web/getting-started.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="../articles/web/penalties.html">Penalties</a>
    </li>
    <li>
      <a href="../articles/web/adaptive-rescaling.html">Standardization</a>
    </li>
    <li>
      <a href="../articles/web/inference-mfdr.html">Inference: Marginal false discovery rates</a>
    </li>
    <li>
      <a href="../articles/web/inference-local.html">Inference: Local mfdr</a>
    </li>
    <li>
      <a href="../articles/web/other-cv-criteria.html">Other CV criteria</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pbreheny/ncvreg" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permute residuals for a fitted ncvreg model</h1>
    <small class="dont-index">Source: <a href="https://github.com/pbreheny/ncvreg/blob/HEAD/R/permres-ncvreg.R" class="external-link"><code>R/permres-ncvreg.R</code></a></small>
    <div class="hidden name"><code>permres.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits multiple penalized regression models in which the residuals are
randomly permuted, thereby allowing estimation of the marginal false
discovery rate.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">permres</span><span class="op">(</span><span class="va">fit</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for ncvreg</span></span>
<span><span class="fu">permres</span><span class="op">(</span><span class="va">fit</span>, <span class="va">lambda</span>, N <span class="op">=</span> <span class="fl">10</span>, <span class="va">seed</span>, trace <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fit</dt>
<dd><p>A fitted ncvreg model, as produced by <code><a href="ncvreg.html">ncvreg</a>()</code>. To
use with <code>permres</code>, the model must be fit using the <code>returnX=TRUE</code>
option.</p></dd>


<dt>...</dt>
<dd><p>Not used.</p></dd>


<dt>lambda</dt>
<dd><p>The regularization parameter to use for estimating residuals.
Unlike <code><a href="perm.ncvreg.html">perm.ncvreg</a></code>, <code>permres</code> calculates EF and mFDR for
a specific <code>lambda</code> value, not an entire path.  As a result, it runs
much faster.</p></dd>


<dt>N</dt>
<dd><p>The number of permutation replications.  Default is 10.</p></dd>


<dt>seed</dt>
<dd><p>You may set the seed of the random number generator in order to
obtain reproducible results.</p></dd>


<dt>trace</dt>
<dd><p>If set to TRUE, perm.ncvreg will inform the user of its
progress by announcing the beginning of each permutation fit. Default is
FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the following components:</p>
<dl><dt>EF</dt>
<dd><p>The number of
variables selected at each value of <code>lambda</code>, averaged over the
permutation fits.</p></dd>
 <dt>S</dt>
<dd><p>The actual number of selected variables for the
non-permuted data.</p></dd>
 <dt>mFDR</dt>
<dd><p>The estimated marginal false discovery rate
(<code>EF/S</code>).</p></dd>
 <dt>loss</dt>
<dd><p>The loss/deviance, averaged over the permutation
fits.  This is an estimate of the explanatory power of the model under null
conditions, and can be used to adjust the loss of the fitted model in a
manner akin to the idea of an adjusted R-squared in classical regression.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function fits a penalized regression model to the actual data, then
repeats the process <code>N</code> times with a permuted version of the response
vector.  This allows estimation of the expected number of variables included
by chance for each value of <code>lambda</code>.  The ratio of this expected
quantity to the number of selected variables using the actual (non-permuted)
response is called the marginal false discovery rate (mFDR).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ncvreg.html">ncvreg</a></code>, <code><a href="mfdr.html">mfdr</a></code>, <code><a href="perm.ncvreg.html">perm.ncvreg</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Patrick Breheny <a href="mailto:patrick-breheny@uiowa.edu">patrick-breheny@uiowa.edu</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ncvreg.html">ncvreg</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">$</span><span class="va">X</span>, <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span>, N<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">permres</span><span class="op">(</span><span class="va">fit</span>, lambda<span class="op">=</span><span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $EF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $S</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mFDR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.1500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1666667 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $loss</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 48.81045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

