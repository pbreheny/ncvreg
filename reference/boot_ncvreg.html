<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hybrid Bootstrap Confidence Intervals — boot_ncvreg • ncvreg</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Hybrid Bootstrap Confidence Intervals — boot_ncvreg"><meta name="description" content="Performs a hybrid bootstrapping approach to construct quantile based
confidence intervals around the original lasso/MCP/SCAD estimator.
Specifically, a traditional pairs bootstrap is performed with 1 adjustment:
if the bootstrap sample for a given covariate is zero, a random sample from
the full conditional posterior is used as the bootstrap sample instead.
This avoids the creation of intervals with endpoints exactly equal to zero."><meta property="og:description" content="Performs a hybrid bootstrapping approach to construct quantile based
confidence intervals around the original lasso/MCP/SCAD estimator.
Specifically, a traditional pairs bootstrap is performed with 1 adjustment:
if the bootstrap sample for a given covariate is zero, a random sample from
the full conditional posterior is used as the bootstrap sample instead.
This avoids the creation of intervals with endpoints exactly equal to zero."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ncvreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.15.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more"><li><a class="dropdown-item" href="../articles/models">Models</a></li>
    <li><a class="dropdown-item" href="../articles/penalties">Penalties</a></li>
    <li><a class="dropdown-item" href="../articles/adaptive-rescaling">Standardization</a></li>
    <li><a class="dropdown-item" href="../articles/inference-mfdr">Inference: Marginal false discovery rates</a></li>
    <li><a class="dropdown-item" href="../articles/inference-local">Inference: Local mfdr</a></li>
    <li><a class="dropdown-item" href="../articles/other-cv-criteria">Other CV criteria</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/ncvreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hybrid Bootstrap Confidence Intervals</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/ncvreg/blob/master/R/boot-ncvreg.R" class="external-link"><code>R/boot-ncvreg.R</code></a></small>
      <div class="d-none name"><code>boot_ncvreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs a hybrid bootstrapping approach to construct quantile based
confidence intervals around the original lasso/MCP/SCAD estimator.
Specifically, a traditional pairs bootstrap is performed with 1 adjustment:
if the bootstrap sample for a given covariate is zero, a random sample from
the full conditional posterior is used as the bootstrap sample instead.
This avoids the creation of intervals with endpoints exactly equal to zero.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boot_ncvreg</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">fit</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  <span class="va">cluster</span>,</span>
<span>  <span class="va">seed</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  penalty <span class="op">=</span> <span class="st">"lasso"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  gamma <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">penalty</span>, SCAD <span class="op">=</span> <span class="fl">3.7</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  returnCV <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_boot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The design matrix, without an intercept. <code>boot_ncvreg</code>
standardizes the data and includes an intercept by default.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response vector.</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>(optional) An object of class <code>ncvreg</code> or
<code>cv.ncvreg</code>. An object of class <code>ncvreg</code>
provides data, penalty choices, and <code>lambda</code> sequence to
<code>boot_ncvreg</code>. An object of class <code>cv.ncvreg</code> can in
addition can provide information for selecting <code>lambda</code>
and estimating <code>sigma2</code>. If provided, <code>y</code> should not
be provided and <code>X</code> should only be provided if <code>fit</code>
does not contain <code>X</code>.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>(optional) The value of lambda to provide interval estimates
for. If left missing will be selected using CV. If user wants
to set the lambda sequence used to select <code>lambda</code> via
cross validation, they should call <code>cv.ncvreg</code> separately
and pass the resulting object to <code>fit</code>.</p></dd>


<dt id="arg-sigma-">sigma2<a class="anchor" aria-label="anchor" href="#arg-sigma-"></a></dt>
<dd><p>(optional) The variance to use for the Hybrid sampling. If
left missing will be set using the estimator suggested by Reid
et. al. (2016) using CV.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>Bootstrapping and <code>cv.ncvreg</code> (if applicable) can be run
in parallel across a cluster using the <strong>parallel</strong> package.
The cluster must be set up in advance using the
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code> function from that package. The
cluster must then be passed to <code>boot_ncvreg</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>You may set the seed of the random number generator in order
to obtain reproducible results. This is set for the overall
process. If the user wishes to set a seed specifically for
<code>cv.ncvreg</code> they should call it separately then pass the
fitted object as an argument to <code>fit</code>.</p></dd>


<dt id="arg-nboot">nboot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>The number of bootstrap replications to use.</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>The penalty to be applied to the model.  Either "lasso" (the
default), "MCP", or "SCAD".</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>The confidence level required.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>The tuning parameter of the MCP/SCAD penalty
(see <code>ncvreg</code> for details). Default is 3 for MCP and 3.7
for SCAD. Ignored if fit is provided.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Tuning parameter for the Elastc net estimator which controls
the relative contributions from the lasso/MCP/SCAD penalty and
the ridge, or L2 penalty. <code>alpha=1</code> is equivalent to
lasso/MCP/SCAD penalty, while <code>alpha=0</code> would be equivalent to
ridge regression. However, <code>alpha=0</code> is not supported; <code>alpha</code>
may be arbitrarily small, but not exactly 0. Ignored if fit is
provided.</p></dd>


<dt id="arg-returncv">returnCV<a class="anchor" aria-label="anchor" href="#arg-returncv"></a></dt>
<dd><p>If <code>TRUE</code>, the <code>cv.ncvreg</code> fit will be returned
(if applicable).</p></dd>


<dt id="arg-return-boot">return_boot<a class="anchor" aria-label="anchor" href="#arg-return-boot"></a></dt>
<dd><p>If <code>TRUE</code>, the bootstrap draws will be returned.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>FALSE</code>, non-essential messages are suppressed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>named arguments to be passed to <code>ncvreg</code> and
<code>cv.ncvreg</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with:</p><dl><dt>confidence_intervals</dt>
<dd><p>A <code>data.frame</code> with the original point estimates along with lower and upper bounds of Hybrid CIs.</p></dd>

<dt>lambda</dt>
<dd><p>The value of <code>lambda</code> the <code>confidence_intervals</code> were constructed at.</p></dd>

<dt>sigma2</dt>
<dd><p>The value of <code>sigma2</code> used for the Hybrid bootstrap sampling.</p></dd>

<dt>penalty</dt>
<dd><p>The penalty the intervals correspond to.</p></dd>

<dt>alpha</dt>
<dd><p>The tuning parameter for the Enet estimator used.</p></dd>

<dt>level</dt>
<dd><p>The confidence level the intervals correspond to.</p></dd>


</dl><p>If a penalty other than "lasso" is used,</p><dl><dt>gamma</dt>
<dd><p>The tuning parameter for MCP/SCAD penalty.</p></dd>


</dl><p>If <code>returnCV</code> is <code>TRUE</code> and a <code>cv.ncvreg</code> object was fit or supplied</p><dl><dt>cv.ncvreg</dt>
<dd><p>The <code>cv.ncvreg</code> fit used to estimate <code>lambda</code> and <code>sigma2</code> (if applicable).</p></dd>


</dl><p>If <code>return_boot</code> is <code>TRUE</code></p><dl><dt>boot_draws</dt>
<dd><p>A <code>data.frame</code> of the Hybrid bootstrap draws are returned.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The resulting intervals WILL NOT have exact nominal coverage for all
covariates. They are instead constructed in a way that overall coverage will
be approximately equal to nominal so long as the true distribution of betas
is Laplace and the covariates are independent. That said, in practice,
average coverage is fairly robust to these assumptions.</p>
<p>Note: Draws from the full conditional posterior are approximations for
MCP/SCAD or when <code>alpha</code> is not 1.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">X</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="fu">boot_ncvreg</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, level <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $confidence_intervals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            estimates        lower       upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcavol   0.503026841  0.404728898 0.586902108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lweight  0.527075968  0.257928278 0.797639985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age     -0.005614408 -0.018248826 0.003226695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lbph     0.053045414  0.002453304 0.134015759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svi      0.578015027  0.286291653 0.878599358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcp      0.000000000 -0.050689642 0.056656446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gleason  0.000000000 -0.055472882 0.149736920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pgg45    0.002017161 -0.000859797 0.005745635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04501119</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.494889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $penalty</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lasso"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny, Ryan Miller, Logan Harris.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

