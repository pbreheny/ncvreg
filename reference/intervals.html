<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Projection base test statistics and intervals — intervals • ncvreg</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Projection base test statistics and intervals — intervals"><meta name="description" content="Constructs projection based test statistics that can be used to control FDR
along with intervals for a penalized regression model."><meta property="og:description" content="Constructs projection based test statistics that can be used to control FDR
along with intervals for a penalized regression model."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ncvreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.16.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ncvreg.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../articles/penalties.html">Penalties</a></li>
    <li><a class="dropdown-item" href="../articles/adaptive-rescaling.html">Standardization and adaptive rescaling</a></li>
    <li><a class="dropdown-item" href="../articles/inference-mfdr.html">Inference: Marginal false discovery rates</a></li>
    <li><a class="dropdown-item" href="../articles/inference-local.html">Inference: Local mfdr</a></li>
    <li><a class="dropdown-item" href="../articles/other-cv-criteria.html">Other CV criteria</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/ncvreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Projection base test statistics and intervals</h1>
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/ncvreg/blob/main/R/intervals.R" class="external-link"><code>R/intervals.R</code></a></small>
      <div class="d-none name"><code>intervals.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructs projection based test statistics that can be used to control FDR
along with intervals for a penalized regression model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">intervals</span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">sigma</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  posterior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  relaxed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  adjust_projection <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  X <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>An optional fit of class <code>ncvreg</code> or <code>cv.ncvreg</code>. If supplied,
<code>X</code> should only be supplied if <code>fit</code> does not contain it.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>The penalty at which the tests and intervals are to
be constructed. If left unspecified, will be selected using
cross validation.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Standard deviation estimate used to compute test statistic and
intervals. If left unspecified (default) it will be
estimated using the recommendation from Reid et al. (2016)</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>the confidence level required.</p></dd>


<dt id="arg-posterior">posterior<a class="anchor" aria-label="anchor" href="#arg-posterior"></a></dt>
<dd><p>whether the intervals returned should be posterior intervals
(default) or debiased intervals (if <code>FALSE</code>). Posterior
intervals are constructed from distributions where the
coefficient estimates are the is the posterior mode. Debiased
intervals are constructed around the estimates.</p></dd>


<dt id="arg-relaxed">relaxed<a class="anchor" aria-label="anchor" href="#arg-relaxed"></a></dt>
<dd><p>whether the relaxed lasso based statistic / intervals should
be used. Default is <code>FALSE</code> in which case PIPE based intervals
are constructed (recommended). This affects the estimate.</p></dd>


<dt id="arg-adjust-projection">adjust_projection<a class="anchor" aria-label="anchor" href="#arg-adjust-projection"></a></dt>
<dd><p>whether a Local Quadratic Approximation should be
used in the projection for determining variance of the PIPE
based test statistic. Default is <code>FALSE</code> as more research has
been done without this adjustment, however without this
adjustment, statistics and intervals may be over conservative in
the presence of correlation. This affects the SE.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The original design matrix supplied to <code>fit</code>. Required if <code>fit</code>
does not contain <code>X</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>data.frame</code> containing the following columns:</p><dl><dt>variable</dt>
<dd><p><code>colnames(X)</code></p></dd>

<dt>coef</dt>
<dd><p>The original estimates at the specified parameters (<code>lambda</code>, <code>gamma</code>, <code>alpha</code>)</p></dd>

<dt>estimate</dt>
<dd><p>The debiased estimates.</p></dd>

<dt>SE</dt>
<dd><p>The standard errors.</p></dd>

<dt>t</dt>
<dd><p>The PIPE / Relaxed Lasso / LQA test statistics</p></dd>

<dt>lower</dt>
<dd><p>Interval lower bounds</p></dd>

<dt>upper</dt>
<dd><p>Intervals upper bounds</p></dd>

<dt>p.value</dt>
<dd><p>The unadjusted p-value</p></dd>

<dt>p.adjust</dt>
<dd><p>The Benhamini and Hochberg corrected p-value</p></dd>

<dt>penalty</dt>
<dd><p>The penalty used.</p></dd>

<dt>lambda</dt>
<dd><p>The lambda value the test statistics and intervals were constructed at.</p></dd>

<dt>gamma</dt>
<dd><p>The gamma value the test statistics and intervals were constructed at (for MCP/SCAD).</p></dd>

<dt>alpha</dt>
<dd><p>The alpha value the test statistics and intervals were constructed at.</p></dd>

<dt>level</dt>
<dd><p>The confidence level set for interval construction.</p></dd>

<dt>sigma</dt>
<dd><p>The standard deviation used for constructing the test statistis and intervals.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function constructs test statistics and intervals based off an
approximate projection onto the column space of the active features. The test
statistic can be used to control FDR and the intervals generally
have good coverage. However, both tend to be conservative with the
introduction of correlation.</p>
<p>The intervals produced can either be biased (like the point estimates) or
debiased by setting the parameter <code>posterior</code> accordingly. The resulting
behavior is quite different. See references for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Harris L and Breheny P. (2025) A new perspective on high dimensional confidence intervals.
<em>arXiv preprint</em>, arXiv:2508.03504.
<a href="https://arxiv.org/abs/2508.03504" class="external-link">https://arxiv.org/abs/2508.03504</a></p>
<p>Harris L and Breheny P. (2025) Alternative Likelihood Approximations for High-Dimensional Intervals for Lasso.
<em>arXiv preprint</em>, arXiv:2509.14971.
<a href="https://arxiv.org/abs/2509.14971" class="external-link">https://arxiv.org/abs/2509.14971</a></p>
<p>Dai B. (2019) Projection-based inference and model selection for penalized regression.
PhD dissertation, University of Iowa, Iowa City, IA.
<a href="https://doi.org/10.17077/etd.005250" class="external-link">doi:10.17077/etd.005250</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Logan Harris, Patrick Breheny, and Biyue Dai</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Linear regression (SCAD-Net penalty, PIPE intervals, pass ncvreg object)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ncvreg.html">ncvreg</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">$</span><span class="va">X</span>, <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">intervals</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         variable        coef    estimate         SE         t       lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcavol    lcavol  0.56705170  0.56823231 0.08536950  6.656151  0.39993486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lweight  lweight  0.61396251  0.61523624 0.19734546  3.117560  0.22673738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          age -0.02075306 -0.02079495 0.01091667 -1.904881 -0.04210383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lbph        lbph  0.09698225  0.09717897 0.05726386  1.697039 -0.01541831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svi          svi  0.74938522  0.75104331 0.23685484  3.170901  0.28524770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcp          lcp -0.10234574 -0.10256268 0.08884987 -1.154337 -0.27616791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                upper      p.value     p.adjust penalty    lambda gamma alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcavol  0.7342398444 2.810907e-11 2.248726e-10    SCAD 0.0201901   3.7   0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lweight 1.0003747644 1.823550e-03 4.862801e-03    SCAD 0.0201901   3.7   0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age     0.0008049362 5.679554e-02 1.135911e-01    SCAD 0.0201901   3.7   0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lbph    0.2089392044 8.968937e-02 1.435030e-01    SCAD 0.0201901   3.7   0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svi     1.2132756360 1.519668e-03 4.862801e-03    SCAD 0.0201901   3.7   0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcp     0.0714558667 2.483621e-01 2.838424e-01    SCAD 0.0201901   3.7   0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         level    sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcavol   0.95 0.692084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lweight  0.95 0.692084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age      0.95 0.692084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lbph     0.95 0.692084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> svi      0.95 0.692084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcp      0.95 0.692084</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Logistic regression (lasso penalty, LQA intervals, pass cv.ncvreg object) </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Heart</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cv_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="cv.ncvreg.html">cv.ncvreg</a></span><span class="op">(</span><span class="va">Heart</span><span class="op">$</span><span class="va">X</span>, <span class="va">Heart</span><span class="op">$</span><span class="va">y</span>, family<span class="op">=</span><span class="st">"binomial"</span>, penalty <span class="op">=</span> <span class="st">"lasso"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">intervals</span><span class="op">(</span><span class="va">cv_fit</span>, adjust_projection <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            variable        coef    estimate         SE         t        lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sbp             sbp 0.004591841 0.006691921 0.00542863 1.2327090 -0.004042523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tobacco     tobacco 0.072039912 0.081846321 0.02488849 3.2885212  0.023402587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ldl             ldl 0.153354310 0.175073685 0.05424203 3.2276386  0.047449143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adiposity adiposity 0.000000000 0.004350699 0.01881224 0.2312696 -0.029110113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> famhist     famhist 0.828918109 0.917515358 0.22125877 4.1467977  0.395299160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typea         typea 0.031161890 0.036060712 0.01169760 3.0827432  0.008391284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                upper      p.value     p.adjust penalty      lambda gamma alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sbp       0.01537976 2.176844e-01 0.3244134078   lasso 0.008236943     3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tobacco   0.12081978 1.007152e-03 0.0028083724   lasso 0.008236943     3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ldl       0.25967645 1.248165e-03 0.0028083724   lasso 0.008236943     3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adiposity 0.03657256 8.171053e-01 0.8810252658   lasso 0.008236943     3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> famhist   1.26256560 3.371576e-05 0.0001517209   lasso 0.008236943     3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typea     0.05409455 2.051020e-03 0.0036918367   lasso 0.008236943     3     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           level sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sbp        0.95    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tobacco    0.95    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ldl        0.95    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adiposity  0.95    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> famhist    0.95    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typea      0.95    NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny, Ryan Miller, Logan Harris.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Last updated: December 11, 2025</p>
</div>

    </footer></div>





  </body></html>

