<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Direct interface for nonconvex penalized regression (non-pathwise) — ncvfit • ncvreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Direct interface for nonconvex penalized regression (non-pathwise) — ncvfit"><meta property="og:description" content="This function is intended for users who know exactly what they're doing and want complete
control over the fitting process:
no standardization is applied, no intercept is included, no path is fit.
All of these things are best practices for data analysis, so if you are choosing not to do
them, you are on your own – there is no guarantee that your results will be meaningful.
Some things in particular that you should pay attention to:
If your model has an intercept, it is up to you to (un)penalize it properly, typically
by settings its corresponding element of penalty.factor to zero.
You should provide initial values for the coefficients; in nonconvex optimization,
initial values are very important in determining which local solution an algorithm
converges to.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ncvreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.14.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/web/getting-started.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Learn more

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="../articles/web/penalties.html">Penalties</a>
    </li>
    <li>
      <a href="../articles/web/adaptive-rescaling.html">Standardization</a>
    </li>
    <li>
      <a href="../articles/web/inference-mfdr.html">Inference: Marginal false discovery rates</a>
    </li>
    <li>
      <a href="../articles/web/inference-local.html">Inference: Local mfdr</a>
    </li>
    <li>
      <a href="../articles/web/other-cv-criteria.html">Other CV criteria</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/pbreheny/ncvreg" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Direct interface for nonconvex penalized regression (non-pathwise)</h1>
    <small class="dont-index">Source: <a href="https://github.com/pbreheny/ncvreg/blob/master/R/ncvfit.R" class="external-link"><code>R/ncvfit.R</code></a></small>
    <div class="hidden name"><code>ncvfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is intended for users who know exactly what they're doing and want complete
control over the fitting process:
no standardization is applied, no intercept is included, no path is fit.
All of these things are best practices for data analysis, so if you are choosing not to do
them, you are on your own – there is no guarantee that your results will be meaningful.
Some things in particular that you should pay attention to:</p><ul><li><p>If your model has an intercept, it is up to you to (un)penalize it properly, typically
by settings its corresponding element of <code>penalty.factor</code> to zero.</p></li>
<li><p>You should provide initial values for the coefficients; in nonconvex optimization,
initial values are very important in determining which local solution an algorithm
converges to.</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ncvfit</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">r</span>,</span>
<span>  <span class="va">xtx</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCP"</span>, <span class="st">"SCAD"</span>, <span class="st">"lasso"</span><span class="op">)</span>,</span>
<span>  gamma <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">penalty</span>, SCAD <span class="op">=</span> <span class="fl">3.7</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  penalty.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Design matrix; no intercept will be added, no standardization
will occur (n x p matrix)</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Response vector (length n vector)</p></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>Initial values for beta.  Default: zero (length p vector)</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Residuals corresponding to <code>init</code>; these will be calculated if not
supplied, but if they have already been calculated elsewhere, it is
more efficient to pass them as an argument. WARNING: If you supply
an incorrect value of <code>r</code>, the solution will be incorrect. (length
n vector)</p></dd>


<dt id="arg-xtx">xtx<a class="anchor" aria-label="anchor" href="#arg-xtx"></a></dt>
<dd><p>X scales: the jth element should equal <code>crossprod(X[,j])/n</code>. These
will be calculated if not supplied, but if they have already been
calculated elsewhere, it is more efficient to pass them as an
argument.  In particular, if X is standardized, one should pass
<code>xtx = rep(1, p)</code>.  WARNING: If you supply an incorrect value of
<code>xtx</code>, the solution will be incorrect. (length p vector)</p></dd>


<dt id="arg-penalty">penalty<a class="anchor" aria-label="anchor" href="#arg-penalty"></a></dt>
<dd><p>Penalty function to be applied, either "MCP" (default), "SCAD", or
"lasso")</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Tuning parameter of the MCP/SCAD penalty, as in <code><a href="ncvreg.html">ncvreg()</a></code>; default
is 3 for MCP and 3.7 for SCAD.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Tuning paramter controlling the ridge component of penalty, as in
<code><a href="ncvreg.html">ncvreg()</a></code>; default is 1 (meaning no ridge penalty)</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Regularization parameter value at which to estimate beta; must be
scalar – for pathwise optimization, see <code><a href="ncvreg.html">ncvreg()</a></code></p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Convergence threshhold. The algorithm iterates until the RMSD for
the change in linear predictors for each coefficient is less than
eps. Default is 1e-4.</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum number of allowed iterations; if this number is reached,
algorithm will terminate prior to convergence.  Default: 1000.</p></dd>


<dt id="arg-penalty-factor">penalty.factor<a class="anchor" aria-label="anchor" href="#arg-penalty-factor"></a></dt>
<dd><p>Multiplicative factor for the penalty applied to each coefficient,
as in <code><a href="ncvreg.html">ncvreg()</a></code>.  In particular, note that if you include an
intercept, you probably want to set its entry to zero here.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>Return warning messages for failures to converge and model
saturation? Default is TRUE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p><ul><li><p><code>beta</code>: The estimated regression coefficients</p></li>
<li><p><code>iter</code>: The number of iterations required to solve for `beta</p></li>
<li><p><code>loss</code>: The loss (residual sum of squares) at convergence</p></li>
<li><p><code>resid</code>: The residuals at convergence</p></li>
<li><p><code>lambda</code>: See above</p></li>
<li><p><code>penalty</code>: See above</p></li>
<li><p><code>gamma</code>: See above</p></li>
<li><p><code>alpha</code>: See above</p></li>
<li><p><code>penalty.factor</code>: See above</p></li>
<li><p><code>n</code>: Sample size</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>At the moment, this function only works for least-squares loss functions.  Additional
functionality for other loss functions (logistic, Cox) is in development.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Prostate</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">ncvfit</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, lambda<span class="op">=</span><span class="fl">0.1</span>, penalty.factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    lcavol      lweight          age         lbph          svi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2.268444208  0.677388754  0.000000000 -0.013317940  0.143711214  0.000000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lcp      gleason        pgg45 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.000000000  0.000000000  0.005398707 </span>
<span class="r-in"><span><span class="co"># Compare with:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="ncvreg.html">ncvreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span><span class="op">)</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                  lcavol     lweight         age        lbph </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.6973059   0.0000000   0.5387509   0.6382717   0.0000000   0.0000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         svi         lcp     gleason       pgg45 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.6102800   0.0000000   0.0000000   0.0000000 </span>
<span class="r-in"><span><span class="co"># The unstandardized version makes little sense here, as it fails to account</span></span></span>
<span class="r-in"><span><span class="co"># for differences in the scales of the predictors.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

