<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with ncvreg • ncvreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Getting started with ncvreg">
<meta property="og:description" content="ncvreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">ncvreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.14.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/web/getting-started.html">Getting started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="../../articles/web/penalties.html">Penalties</a>
    </li>
    <li>
      <a href="../../articles/web/adaptive-rescaling.html">Standardization</a>
    </li>
    <li>
      <a href="../../articles/web/inference-mfdr.html">Inference: Marginal false discovery rates</a>
    </li>
    <li>
      <a href="../../articles/web/inference-local.html">Inference: Local mfdr</a>
    </li>
    <li>
      <a href="../../articles/web/other-cv-criteria.html">Other CV criteria</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functions</a>
</li>
<li>
  <a href="../../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pbreheny/ncvreg" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with ncvreg</h1>
                        <h4 data-toc-skip class="author">Patrick
Breheny</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/ncvreg/blob/HEAD/vignettes/web/getting-started.rmd" class="external-link"><code>vignettes/web/getting-started.rmd</code></a></small>
      <div class="hidden name"><code>getting-started.rmd</code></div>

    </div>

    
    
<p><code>ncvreg</code> is an R package for fitting regularization paths
for linear regression, GLM, and Cox regression models using lasso or
nonconvex penalties, in particular the minimax concave penalty (MCP) and
smoothly clipped absolute deviation (SCAD) penalty, with options for
additional L<sub>2</sub> penalties (the “elastic net” idea). Utilities
for carrying out cross-validation as well as post-fitting visualization,
summarization, inference, and prediction are also provided.</p>
<p><code>ncvreg</code> comes with a few example data sets; we’ll look at
<code>Prostate</code>, which has 8 features and one continuous response,
the PSA levels (on the log scale) from men about to undergo radical
prostatectomy:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Prostate</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Prostate</span><span class="op">$</span><span class="va">y</span></span></code></pre></div>
<p>To fit a penalized regression model to this data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/ncvreg.html">ncvreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>The default penalty here is the minimax concave penalty (MCP), but
SCAD and lasso penalties are also available. This produces a path of
coefficients, which we can plot with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-1.png" width="480"></p>
<p>Notice that variables enter the model one at a time, and that at any
given value of <span class="math inline">\(\lambda\)</span>, several
coefficients are zero. To see what the coefficients are, we could use
the <code>coef</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span>, lambda<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co"># (Intercept)      lcavol     lweight         age        lbph         svi </span></span>
<span><span class="co">#  0.35121089  0.53178994  0.60389694 -0.01530917  0.08874563  0.67256096 </span></span>
<span><span class="co">#         lcp     gleason       pgg45 </span></span>
<span><span class="co">#  0.00000000  0.00000000  0.00168038</span></span></code></pre></div>
<p>The <code>summary</code> method can be used for post-selection
inference:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, lambda<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co"># MCP-penalized linear regression with n=97, p=8</span></span>
<span><span class="co"># At lambda=0.0500:</span></span>
<span><span class="co"># -------------------------------------------------</span></span>
<span><span class="co">#   Nonzero coefficients         :   6</span></span>
<span><span class="co">#   Expected nonzero coefficients:   2.54</span></span>
<span><span class="co">#   Average mfdr (6 features)    :   0.424</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#         Estimate      z     mfdr Selected</span></span>
<span><span class="co"># lcavol   0.53179  8.880  &lt; 1e-04        *</span></span>
<span><span class="co"># svi      0.67256  3.945 0.010189        *</span></span>
<span><span class="co"># lweight  0.60390  3.666 0.027894        *</span></span>
<span><span class="co"># lbph     0.08875  1.928 0.773014        *</span></span>
<span><span class="co"># age     -0.01531 -1.788 0.815269        *</span></span>
<span><span class="co"># pgg45    0.00168  1.160 0.917570        *</span></span></code></pre></div>
<p>In this case, it would appear that <code>lcavol</code>,
<code>svi</code>, and <code>lweight</code> are clearly associated with
the response, even after adjusting for the other variables in the model,
while <code>lbph</code>, <code>age</code>, and <code>pgg45</code> may be
false positives included simply by chance.</p>
<p>Typically, one would carry out cross-validation for the purposes of
assessing the predictive accuracy of the model at various values of
<span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/cv.ncvreg.html">cv.ncvreg</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span>
<span><span class="co"># MCP-penalized linear regression with n=97, p=8</span></span>
<span><span class="co"># At minimum cross-validation error (lambda=0.0169):</span></span>
<span><span class="co"># -------------------------------------------------</span></span>
<span><span class="co">#   Nonzero coefficients: 7</span></span>
<span><span class="co">#   Cross-validation error (deviance): 0.55</span></span>
<span><span class="co">#   R-squared: 0.59</span></span>
<span><span class="co">#   Signal-to-noise ratio: 1.42</span></span>
<span><span class="co">#   Scale estimate (sigma): 0.739</span></span>
<span><span class="co"># MCP-penalized linear regression with n=97, p=8</span></span>
<span><span class="co"># At lambda=0.0169:</span></span>
<span><span class="co"># -------------------------------------------------</span></span>
<span><span class="co">#   Nonzero coefficients         :   7</span></span>
<span><span class="co">#   Expected nonzero coefficients:   2.71</span></span>
<span><span class="co">#   Average mfdr (7 features)    :   0.386</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#          Estimate      z      mfdr Selected</span></span>
<span><span class="co"># lcavol   0.569546  8.902   &lt; 1e-04        *</span></span>
<span><span class="co"># svi      0.752397  4.131 0.0039506        *</span></span>
<span><span class="co"># lweight  0.614420  3.491 0.0352445        *</span></span>
<span><span class="co"># age     -0.020913 -2.065 0.6238365        *</span></span>
<span><span class="co"># pgg45    0.005324  1.991 0.6577498        *</span></span>
<span><span class="co"># lcp     -0.104959 -1.946 0.6773540        *</span></span>
<span><span class="co"># lbph     0.097353  1.873 0.7069055        *</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/cvplot-1.png" width="480"></p>
<p>The value of <span class="math inline">\(\lambda\)</span> that
minimizes the cross-validation error is given by
<code>cvfit$lambda.min</code>, which in this case is 0.017. Applying
<code>coef</code> to the output of <code>cv.ncvreg</code> returns the
coefficients at that value of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span>
<span><span class="co">#  (Intercept)       lcavol      lweight          age         lbph          svi </span></span>
<span><span class="co">#  0.494154801  0.569546027  0.614419811 -0.020913467  0.097352536  0.752397339 </span></span>
<span><span class="co">#          lcp      gleason        pgg45 </span></span>
<span><span class="co"># -0.104959403  0.000000000  0.005324465</span></span></code></pre></div>
<p>Predicted values can be obtained via <code>predict</code>, which has
a number of options:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>     <span class="co"># Prediction of response for new observations</span></span>
<span><span class="co">#         1         2         3         4         5         6 </span></span>
<span><span class="co"># 0.8304040 0.7650906 0.4262072 0.6230117 1.7449492 0.8449595</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, type<span class="op">=</span><span class="st">"nvars"</span><span class="op">)</span>  <span class="co"># Number of nonzero coefficients</span></span>
<span><span class="co"># 0.01695 </span></span>
<span><span class="co">#       7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cvfit</span>, type<span class="op">=</span><span class="st">"vars"</span><span class="op">)</span>   <span class="co"># Identity of the nonzero coefficients</span></span>
<span><span class="co">#  lcavol lweight     age    lbph     svi     lcp   pgg45 </span></span>
<span><span class="co">#       1       2       3       4       5       6       8</span></span></code></pre></div>
<p>Note that the original fit (to the full data set) is returned as
<code>cvfit$fit</code>; it is not necessary to call both
<code>ncvreg</code> and <code>cv.ncvreg</code> to analyze a data set.
For example, <code>plot(cvfit$fit)</code> will produce the same
coefficient path plot as <code>plot(fit)</code> above.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
