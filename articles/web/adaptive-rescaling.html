<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Standardization and adaptive rescaling • ncvreg</title>
<script src="../../lightswitch.js"></script><script src="../../katex-auto.js"></script><script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><link href="../../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Standardization and adaptive rescaling">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">ncvreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.15.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../articles/web/getting-started.html">Getting started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more">
<li><a class="dropdown-item" href="../../articles/web/models.html">Models</a></li>
    <li><a class="dropdown-item" href="../../articles/web/penalties.html">Penalties</a></li>
    <li><a class="dropdown-item" href="../../articles/web/adaptive-rescaling.html">Standardization</a></li>
    <li><a class="dropdown-item" href="../../articles/web/inference-mfdr.html">Inference: Marginal false discovery rates</a></li>
    <li><a class="dropdown-item" href="../../articles/web/inference-local.html">Inference: Local mfdr</a></li>
    <li><a class="dropdown-item" href="../../articles/web/other-cv-criteria.html">Other CV criteria</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/ncvreg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Standardization and adaptive rescaling</h1>
                        <h4 data-toc-skip class="author">Patrick
Breheny</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/ncvreg/blob/master/vignettes/web/adaptive-rescaling.rmd" class="external-link"><code>vignettes/web/adaptive-rescaling.rmd</code></a></small>
      <div class="d-none name"><code>adaptive-rescaling.rmd</code></div>
    </div>

    
    
<p>When fitting penalized regression models, it is standard practice
(adopted by <strong>ncvreg</strong>, <a href="https://glmnet.stanford.edu/" class="external-link">glmnet</a>, and many other software
packages) to standardize the coefficients prior to model fitting.
Specifically, this means centering and scaling each feature so that</p>
<p><span class="math display">\begin{align*}
\frac{1}{n} \sum_{i=1}^n x_{ij} &amp;= 0 \\
\frac{1}{n} \sum_{i=1}^n x_{ij}^2 &amp;= 1.
\end{align*}</span></p>
<p>Fitting takes place on this standardized scale, but the inverse
transformation is applied so that coefficients are returned on the
original scale. This is appealing from a computational perspective, but
also ensures equivariance with respect to the scale of the features
(i.e., one obtains the same predicted values if features are measured in
inches or meters, and so on).</p>
<p>For logistic, Poisson, and Cox regression models,
<strong>ncvreg</strong> adopts the approach of constructing quadratic
approximations to the loss function before updating estimates of the
regression coefficients:</p>
<p><span class="math display"> Q_{\lambda,\gamma}(\boldsymbol{\beta})
\approx \frac{1}{2n}(\tilde{y}-
\mathbf{X}\boldsymbol{\beta})'\mathbf{W}(\tilde{y}-\mathbf{X}\boldsymbol{\beta})
+ \sum_{j=1}^p p_{\lambda,\gamma}(\left\lvert\beta_j\right\rvert).
</span></p>
<p>The equivalent standardization conditions for this weighted least
squares loss are</p>
<p><span class="math display">\begin{align*}
\frac{1}{n} \sum_{i=1}^n w_i x_{ij} &amp;= 0 \\
\frac{1}{n} \sum_{i=1}^n w_i x_{ij}^2 &amp;= 1.
\end{align*}</span></p>
<p>However, because the approximation is iterative, the weights are
continually changing and these conditions cannot simply be imposed at
the outset. There are (at least) two reasonable courses of action here.
One is to simply impose the original standardization conditions and work
around the fact that features are no longer standardized during the
coordinate descent fitting steps. The other is to continuously enforce
the weighted standardization conditions; in <strong>ncvreg</strong>, we
refer to this as “adaptive rescaling.”</p>
<p>For lasso-penalized models, the distinction is not particularly
important. However, for MCP and SCAD, adaptive rescaling changes the
meaning of the <a href="penalties.html"><span class="math inline">\gamma</span> parameter</a>. For example, if <span class="math inline">w_i=0.25</span> for all <span class="math inline">i</span> (as might be the case in logistic
regression), then we would need to set <span class="math inline">\gamma=12</span> in order to obtain a model that
behaves like <span class="math inline">\gamma=3</span> would for linear
regression. To ensure a consistent meaning for <span class="math inline">\gamma</span> across different models (i.e., that
<span class="math inline">\gamma=3</span> remains a reasonable default
in terms of balancing bias and variance), we use adaptive rescaling in
the <strong>ncvreg</strong> package.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Breheny, Ryan Miller, Logan Harris.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
